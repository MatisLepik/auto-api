name: windscreen
category: chassis

identifier:
    msb: 0x00
    lsb: 0x42

api:
    intro: 4
    update: 11

getters: default

setters:
  - name: set_windscreen_damage
    mandatory: [0x03]
    optional: [0x05]
  - name: set_windscreen_replacement_needed
    mandatory: [0x06]
  - name: control_wipers
    mandatory: [0x01]
    optional: [0x02]

state: all

properties:
  - id: 0x01
    name: wipers
    type: enum
    size: 1
    values:
      - id: 0x00
        name: inactive
        verb: deactivate
      - id: 0x01
        name: active
        verb: activate
      - id: 0x02
        name: automatic
  - id: 0x02
    name: wipers_intensity
    type: enum
    size: 1
    values:
      - id: 0x00
        name: level_0
        pretty_name: Level 0, inactive
      - id: 0x01
        name: level_1
      - id: 0x02
        name: level_2
      - id: 0x03
        name: level_3
  - id: 0x03
    name: windscreen_damage
    type: enum
    size: 1
    values:
      - id: 0x00
        name: no_impact_detected
      - id: 0x01
        name: impact_but_no_damage_detected
      - id: 0x02
        name: damage_smaller_than_1_inch
      - id: 0x03
        name: damage_larger_than_1_inch
  - id: 0x04
    name: windscreen_zone_matrix
    type: enum
    size: 1
    values:
      - id: 0x00
        name: unavailable
      - id: 'value & 0xF0'
        name: horizontal_size
        pretty_name: 4 bits representing the horizontal size of the matrix seen from the inside of the car, starting from index 1
      - id: 'value & 0x0F'
        name: vertical_size
        pretty_name: 4 bits representing the vertical size of the matrix, starting from index 1
  - id: 0x05
    name: windscreen_damage_zone
    type: enum
    size: 1
    values:
      - id: 0x00
        name: unknown
      - id: 'value & 0xF0'
        name: horizontal_position
        pretty_name: 4 bits representing the horizontal position of the zone in a matrix seen from the inside of the car, starting from index 1
      - id: 'value & 0x0F'
        name: vertical_position
        pretty_name: 4 bits representing the vertical position of the zone, starting from index 1
  - id: 0x06
    name: windscreen_needs_replacement
    type: enum
    size: 1
    values:
      - id: 0x00
        name: unknown
      - id: 0x01
        name: no_replacement_needed
      - id: 0x02
        name: replacement_needed
  - id: 0x07
    name: windscreen_damage_confidence
    type: double
    size: 8
    description: Percentage between 0.0-1.0, confidence of damage detection. Zero if no impact detected.
  - id: 0x08
    name: windscreen_damage_detection_time
    type: timestamp
    size: 8
    description: Milliseconds since UNIX Epoch time
